package src;

import java.util.Calendar;
import java.util.GregorianCalendar;
import java.text.SimpleDateFormat;


public class StockTradingDay {
	
	static final private int TradeMinutes = (int) (6.5 * 60);
	static final private int StartMinute = 9*60+30;

	private Quote quotes[] = new Quote[TradeMinutes] ;
	
	final public Calendar date;
	
	StockTradingDay(Calendar _date)
	{
		this.date=_date;
	}
	
	private int get_trading_minute(Calendar _time)
	{
		return _time.get(Calendar.MINUTE) + _time.get(Calendar.HOUR_OF_DAY)*60 - StartMinute;
	}
	
	public void set_new_quote(Calendar _date, Quote _quote) throws Exception
	{
		if (_date.get(Calendar.DAY_OF_YEAR) == this.date.get(Calendar.DAY_OF_YEAR) &&
				_date.get(Calendar.DAY_OF_MONTH) == this.date.get(Calendar.DAY_OF_MONTH) &&
				_date.get(Calendar.DATE) == this.date.get(Calendar.DATE) )
		{
			int idx = get_trading_minute(_date);
			
			quotes[idx] = _quote;	
		}
		else 
			throw new Exception("Can't add quote to different date ");
	}
	
	
	public double compute_EMA(double _a, int _period, Calendar _time)
	{
		double sum=0;
		double pow_one_minus_a = 1;
		int idx = get_trading_minute(_time);
		for (int i=0; i<_period; i++)
		{
			sum+= pow_one_minus_a * quotes[idx-i].close;
			pow_one_minus_a*=(1-a);
		}
		
	}
	
	
	
}
