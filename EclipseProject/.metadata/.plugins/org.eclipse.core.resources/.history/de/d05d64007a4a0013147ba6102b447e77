package src;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.Calendar;
import java.util.Date;


public class StockDBFeed extends StockDataFeed {
		private Connection connect = null;
		private ResultSet resultSet = null;
		
		public StockDBFeed(String _host, String _user, String _pw, String _defaultdb) throws ClassNotFoundException, SQLException
		{
			Class.forName("com.mysql.jdbc.Driver");
			 String url = "jdbc:mysql://"+_host+":3306/"+_defaultdb;
			 connect = DriverManager.getConnection(url,_user,_pw);
		}
		
		public void subscrible(String _ticker, Calendar _date) throws SQLException
		{
			PreparedStatement preparedStatement = 
					connect.prepareStatement("select * from MktData.DowJonesMinuteHistory where Ticker in (?) and Date in (?)");
			preparedStatement.setString(1, _ticker);
			preparedStatement.setDate(2, new java.sql.Date(_date.getTimeInMillis()));
			
			resultSet = preparedStatement.executeQuery();
			
		}
		
		Quote get_next_quote() throws Exception
		{
			throw new Exception("StockDateFeed::get_next_quote invalid call to the base method");
		} 
		
 
}
